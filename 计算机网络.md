# Computer Networking

+++

## 一.概述

+++

### 1.因特网

### 2.网络边缘



### 3.网络核心

### 4.接入网和物理媒体

### 5.Internet结构和ISP

### 6.性能指标

+ 速率
+ 带宽
+ 吞吐量
+ 时延
+ 往返时间RTT

### 7.协议层次

+ 应用层
+ 运输层
+ 网络层
+ 链路层
+ 物理层

## 二.应用层

+++

### 应用层协议原理

#### 1.网络应用程序体系结构(application architecture)

+ 客户-服务器体系结构(client-server)

    

+ 对等体系结构(P2P)

    

#### 2.进程通信(process)

#### 3.

#### 4.应用层协议

### Web和HTTP

#### 1.HTTP(超文本传输协议)

+ Web的应用层协议是HTTP

+ Web网页由对象组成

+ HTTP的支撑运输协议是TCP

    ![HTTP.png](C:/Users/79183/Desktop/HTTP.png)

    

#### 2.非持续连接和持续连接

+ 非持续连接(non-presistent connection)

    

+ 持续连接(presistent connection)



#### 3.HTTP报文格式

+ 请求报文

```http
GET /somedir/page.html HTTP/1.1
Host: www.someschool.edu
Connection: close
User-agent: Mozilla/5.0
Accept-language: fr
```



+ 响应报文

```http
HTTP/1.1 200 OK
Connection: close
Date: Tue, 18 Aug 2015 15:44:04 GMT
Server: Apache/2.2.3(CentOS)
Last-Modified: Tue, 18 Aug 2015 15:11:03 GMT
Content-Length: 6821
Content-Type: text/html
(data data data data data ...)
```

响应报文由三部分组成：一个初始状态行(status line)，6个首部行(header line)，最后是实体行(entity body)。

实体部分包含所请求的对象本身

状态行有三个字段：协议版本字段、状态码和相应状态信息

#### 4.用户与服务器交互：Cookie

#### 5.Web缓存(Web cache)

### FTP

FTP采用控制信号和数据信号分离的模式进行传输

### Email

电子邮件有三大组成部分：用户代理(user agent)、邮件服务器(mail server)、简单邮件传输协议(Simpled Mail Transfer Protocol,SMTP)

	1.SMTP

SMTP的 基本操作



SMTP不使用中间邮件服务器

##### 2.SMTP和HTTP区别

HTTP和SMTP的相同点:都用以从一台主机向另一台主机传数据；在传输过程中，持续的HTTP和SMTP都使用持续连接

+ HTTP从Web服务器向Web客户(通常是浏览器)传文件(通常是对象)
+ SMTP从一个邮件服务器向另一个邮件服务器传文件(通常是电子邮件报文)

HTTP和SMTP的区别:

+ HTTP是一个拉协议(pull protocol),即用户通过HTTP从服务器中拉取数据；SMTP是一个推协议(push protocol)，即发送邮件服务器把文件推向接收邮件服务器。
+ SMTP要求每个报文都采用7比特ASCII码格式；HTTP不受这种限制
+ 对于同时含有文本和图形的文档中，HTTP把每个对象封装到自己的HTTP响应报文中，SMTP把所有报文对象装在一个报文之中

#### 3.邮件报文格式



#### 4. 邮件访问协议

##### ①第三版的邮局协议(Post Office Protocol-Version3,POP3)

当用户打开一个到服务器的TCP连接后，POP3便开始工作。经历三个阶段：

+ 特许(authorization)

    用户代理发送(以明文的形式发送)用户名user<user name>和口令pass<password>来鉴别用户。

+ 事务处理

    用户代理取回报文，同时可对报文做删除标记、取消报文删除标记以及获取邮件的统计信息。

    该阶段用户代理会发出一些命令，服务器对这些命令做出回答。回答可能为：

    1)+OK (有时会跟有服务器到客户的数据) 被服务器用来指示前面的命令是正确的

    2)-ERR 被服务器用来指示前面的命令有错误

+ 更新

    在用户发出quit命令后才出现，目的是结束该POP3，此时邮件服务器删除被标记为删除的报文。

##### ②因特网邮件访问协议(Internet Mail Access Protocol,IMAP)



##### ③HTTP

### DNS:因特网的目录服务

主机的两种标识方法：主机名(host)和IP地址

#### 1.DNS提供的服务

域名系统(Domain Name System,DNS)将用户提供的主机名解析为IP地址

DNS:

1. 一个由分层的DNS服务器实现的分布式数据库
2. 一个使得主机能够查询分布式数据库的应用层协议
3. DNS协议运行在UDP之上

#### 2.DNS概述

- DNS工作原理

    用户主机上的应用程序需要将主机名转换成IP地址，调用DNS的客户端，并指明主机名；用户主机上的DNS接收到后，通过UDP传输协议经53端口向网络中发送DNS查询报文，经时延后用户主机接收到一个提供希望映射的DNS回答报文，最终将此映射结果传递给调用DNS的应用程序。

- 分布式、层次数据库



#### 3.DNS的记录和报文



### P2P文件分发

#### 1. P2P体系结构的扩展性

 

## 三.运输层

+++

### 多路复用与多路分解



### 无连接的运输 UDP



### 可靠数据传输(reliable data transfer)

#### rdt1.0



#### rdt2.0



#### rdt3.0



### 面向连接的运输 ： TCP

#### TCP连接

TCP连接提供全双工服务，并且是点对点的，只能单个发送方与单个接收方之间的连接

+ 最大报文段长度（maximum segment size，MSS） ：指在报文段中的应用层数据的最大长度
+ 最大传输单元（maximum transmission unit，MTU）

TCP连接组成：两台主机的缓存、变量和与进程相连接的套接字

#### TCP报文段结构

![TCP报文段结构](E:\xdz\Projects\git\learning-notes\pictures\TCP报文段.png)

TCP报文段=TCP首部字段+数据字段，MSS限制报文段中数据字段的最大长度

TCP发送大文件时，通常是将该文件划分为长度为MSS的若干块来传输

TCP首部

+ **源端口号、目的端口号**：用于多路复用/分解来自或送到上层应用的数据

+ 检验和字段

+ 32比特的序号字段和32比特的确认号字段

    + 序号

        报文段的序号是该报文段首字节的字节流编号 

        第n个序号为 数据流的首字节编号+MSS*(n-1)

    + 确认号 

        + 期望从另一方收到的下一个字节的序号 

            主机A收到从主机B发出的编号为0~535的所有字节，主机A等待主机B的数据流中字节526及之后的所有字节，给主机B发送的报文段的确认号字段中加上536

        + 累积确认

            主机A已收到来自主机B的包含字节0~535的报文段，以及包含字节900~1000的报文段，但并未受到536~899的报文段；主机A为了重新构建主机B的数据流，仍在等待字节536及其后的字节，因此主机A到B的下一个报文段中在确认号字段中包含536

    + TCP收到失序报文段时的解决方法：
        +   接收方立即丢弃失序报文段
        + 接收方保留失序的字节，并等待缺少的字节以填补该缺失

+ 16比特的接收窗口字段：用于流量控制

+ 4比特的首部长度字段

+ 可选与变长的选项字段

+ 6比特的标志字段

    + ACK用于确认字段中的值是有效的
    + RST、SYN、FIN用于连接建立和拆除
    + ECE和CWR在明确用塞通告中

#### 往返时间的估计与超时

估计往返时间

+ SampleRTT

+ EStimatedRTT

+ DevRTT

设置和管理重传超时间间隔



#### 可靠数据传输



#### 流量控制



#### TCP连接管理

 

### 拥塞控制原理

#### 拥塞原因与代价



#### 拥塞控制方法

+ 端到端拥塞控制

    TCP常采用

+ 网络辅助的拥塞控制

    网络提供是否拥塞的信息给端系统



### TCP拥塞控制

​	TCP通过让发送方根据感知到的网络拥塞程度来限制向连接发送流量的速率

+ 检测拥塞

    TCP丢包事件：出现超时/收到接收方的3个冗余ACK

    当出现拥塞时，路由器缓存会溢出，引起数据报的丢失，接着会引起发送方的丢包事件，出现了拥塞的指示

+ 控制发送方的发送速率

    



## 四.网络层：数据平面

+++

### 网络层概述

#### 转发和路由选择：数据平面和控制平面

##### 网络层关键功能

+ 转发 forwarding：数据平面功能

    将分组从一个输入链路接口转移到适当的输出链路接口的路由器本地动作

+ 路由选择 routing：控制平面功能

    确定分组从源到目的地所采取的端到端路径的网络范围处理过程

##### 控制平面

+ 传统的方法

    基于地址+转发表，在路由器中实现

+ SDN方法(Software-Defined Networking)

    基于多个字段+流表，在远程的服务器中实现



### 路由器的工作原理



## 五.网络层：控制平面

+++



## 六.链路层和局域网

+++



